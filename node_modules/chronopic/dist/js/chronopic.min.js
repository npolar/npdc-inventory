!function(){"use strict";function e(e){return"number"==typeof e&&!isNaN(e)&&Math.abs(e)<1/0}function t(e){return"object"==typeof e&&e}function n(e){return"string"==typeof e&&e}function a(e,n){t(e)||(e={});for(var a in n)e.hasOwnProperty(a)||(e[a]=n[a]);return e}function o(e,t){t=a(t,{appendTo:null,context:document,html:"",insertAfter:null,insertBefore:null,replace:null});var o,r,i=e instanceof HTMLElement?e:null;if(n(e)){r=function(e,t){return e.match(/(\[[^\]]+\]|#[^#.\[]+|\.[^#.\[]+|\w+)/g).forEach(function(e){"["==e[0]?(e=e.match(/^\[([^=\]]+)=?([^\]]+)?\]$/))&&(t.attribs[e[1]]=e[2]||""):"."==e[0]?t.classes.push(e.substr(1)):"#"==e[0]?t.attribs.id=e.substr(1):t.tag=e}),t}(e,{attribs:{},classes:[]}),i=t.context.createElement(r.tag),r.classes.forEach(function(e){i.classList.add(e)});for(o in r.attribs)r.attribs.hasOwnProperty(o)&&i.setAttribute(o,r.attribs[o])}(this.element=i).innerHTML=t.html,this.parent=null,this.events={},t.replace?t.replace.parentNode.replaceChild(i,t.replace):t.appendTo?(this.parent=t.appendTo).element.appendChild(i):t.insertAfter?t.insertAfter.parentNode.insertBefore(i,t.insertAfter.nextSibling):t.insertBefore&&t.insertBefore.parentNode.insertBefore(i,t.insertBefore)}function r(e){return{compare:function(t){var n,a=0,o=["getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds"];for(n in o){if(e[o[n]]()!=t[o[n]]())break;a=++n}return a},get days(){return new Date(e.getFullYear(),e.getMonth()+1,0).getDate()},get firstDay(){return new Date(e.getFullYear(),e.getMonth(),1).getDay()},get week(){var t=new Date(e);return t.setHours(0,0,0),t.setDate(t.getDate()+4-(t.getDay()||7)),Math.ceil(((t-new Date(t.getFullYear(),0,1))/864e5+1)/7)}}}function i(e,t){return new o(e,t)}function s(e,t,n){var a=e.getDate(),o=e.getMonth(),i=e.getFullYear(),s=e.getHours(),l=s%12||(n.zeroHour?0:12),c=e.getMinutes(),h=e.getSeconds(),d=r(e).week,u=e.getDay(),f=12>s?n.anteMeridiem:n.postMeridiem;return t.replace(/{date}/gi,n.formatDate).replace(/{datetime}/gi,n.formatDateTime).replace(/{ww}/gi,("0"+d).slice(-2)).replace(/{w}/gi,d).replace(/{DDDD}/g,n.dayOfWeek[u]).replace(/{DDD}/g,n.dayOfWeekShort[u]).replace(/{DD}/g,("0"+a).slice(-2)).replace(/{D}/g,a).replace(/{MMMM}/g,n.monthName[o]).replace(/{MMM}/g,n.monthNameShort[o]).replace(/{MM}/g,("0"+(o+1)).slice(-2)).replace(/{M}/g,o+1).replace(/{YYYY}/g,i).replace(/{YY}/g,i.toString().slice(-2)).replace(/{HH}/g,("0"+s).slice(-2)).replace(/{H}/g,s).replace(/{hh}/g,("0"+l).slice(-2)).replace(/{h}/g,l).replace(/{mm}/g,("0"+c).slice(-2)).replace(/{m}/g,c).replace(/{ss}/g,("0"+h).slice(-2)).replace(/{s}/g,h).replace(/{ap}/g,f)}function l(e,t){var n,a,o=r(new Date(e,t)).firstDay||7,i=new Date(e,t,1-(o-1||7)),s=[];for(n=0;6>n;++n)for(s.push([]),a=0;7>a;++a)s[n].push(new Date(i)),i.setDate(i.getDate()+1);return s}function c(e){var t,n,a=[];for(t=0;3>t;++t)for(a.push([]),n=0;4>n;++n)a[t].push(new Date(e,4*t+n));return a}function h(o,d){function u(t,n,a){for(var o,i,s=f.min,l=f.max;a>(o=r(new Date(t,n,a)).days);)++n,a-=a-o;for(;n>12;)++t,n-=12;if(isNaN(i=new Date(t,n-1,isNaN(a)?1:a))||(t=i.getFullYear(),n=i.getMonth()+1,a=i.getDate()),e(t)){if(e(s.year)&&t<s.year||e(l.year)&&t>l.year)return!1;if(e(n)){if(e(s.month)&&n<s.month&&t<=s.year||e(l.month)&&n>l.month&&t>=l.year)return!1;if(e(a)&&(e(s.day)&&a<s.day&&n<=s.month&&t<=s.year||e(l.day)&&a>l.day&&n>=l.month&&t>=l.year))return!1}}return!0}d=a(d,{className:"chronopic",date:null,format:"{date}",locale:null,max:{year:2100},min:{year:1900},monthYearOnly:!1,onChange:null}),this.format=d.format,this.instances=[],this.max=t(d.max)?d.max:{},this.min=t(d.min)?d.min:{},this.monthYearOnly=d.monthYearOnly===!0?!0:!1,this._i18n=h.i18n.en_GB;var f=this,m=new Date;t(d.date)&&(m=(m=d.date)instanceof Date?new Date(m):new Date(m.year,m.month-1,m.day)),f.max instanceof Date&&(f.max={year:f.max.getFullYear(),month:f.max.getMonth()+1,day:f.max.getDate()}),f.min instanceof Date&&(f.min={year:f.min.getFullYear(),month:f.min.getMonth()+1,day:f.min.getDate()}),(n(o)?Array.prototype.slice.call(document.querySelectorAll(o)):[o]).forEach(function(n){if(n instanceof HTMLElement){h.instances.forEach(function(e){e.instances.forEach(function(e,t,a){e.element.element==n&&(e.element.on(["click","change","keydown"],null),a.splice(t,1))})});var a=n.nextSibling;"DIV"==a.tagName&&a.classList.contains(d.className)||(a=null);var o,f=d.className,g=i("div."+f,{insertAfter:n,replace:a}),p=this,y={};["day","month"].forEach(function(e){g.add(y[e]=i("table.hidden."+e)),y[e].head=i("thead",{appendTo:y[e]}),y[e].body=i("tbody",{appendTo:y[e]})}),p.instances.push(o={date:new Date(m),container:g,element:i(n),selected:{},tables:y,value:"",visible:!1,get day(){return this.date.getDate()},set day(e){u(this.date.getFullYear(),this.date.getMonth()+1,e)&&(this.date.setDate(e),this.selected.day=new Date(this.date))},hide:function(){for(var e in y)y[e].classes.add("hidden");return this.visible=!1,this.selected.month=null,this.selected.day&&(this.date=new Date(this.selected.day),this.selected.month=new Date(this.date)),this},get hour(){return this.date.getHours()},set hour(e){this.date.setHours(e)},get minute(){return this.date.getMinutes()},set minute(e){this.date.setMinutes(e)},get month(){return this.date.getMonth()},set month(e){u(this.date.getFullYear(),e+1)&&(this.date.setMonth(e),this.selected.month=new Date(this.date))},rebuild:function(t){var n,a,o=this,h=o.selected,d=new Date,f=1;if(!t||"day"==t){for(o.tables.day.head.add([i("tr.title").add([i("th.prev[title="+p.locale.prevMonth+"]",{html:"&lt;"}).on("click",function(e){o.date.setDate(1),o.month--,o.show("day"),e.stopPropagation()}),i("th[colspan=6][title="+p.locale.selectMonth+"]",{html:s(o.date,p.locale.titleMonth,p.locale)}).on("click",function(){o.show("month")}),i("th.next[title="+p.locale.nextMonth+"]",{html:"&gt;"}).on("click",function(e){o.date.setDate(1),o.month++,o.show("day"),e.stopPropagation()})]),n=i("tr.labels").add(i("th.week",{html:p.locale.week}))],!0),a=0;7>a;++a)n.add(i("th.day[title="+p.locale.dayOfWeek[f%7]+"]",{html:p.locale.dayOfWeekShort[f++%7]}));o.tables.day.body.clear(),l(o.year,o.month).forEach(function(e){var t=i("tr",{appendTo:o.tables.day.body});t.add(i("td.week",{html:r(e[0]).week})),e.forEach(function(e){var n,a=".day",l=e.getMonth()-o.month,c=!u(e.getFullYear(),e.getMonth()+1,e.getDate()),f=s(e,p.locale.titleDay,p.locale);(-1==l||11==l)&&(a+=".prev"),(1==l||-11==l)&&(a+=".next"),h.day&&r(h.day).compare(e)>=3&&(a+=".selected"),r(e).compare(d)>=3&&(a+=".now"),c&&(a+=".disabled",f+=" ("+p.locale.disabled+")"),t.add(n=i("td[title="+f+"]"+a,{html:e.getDate()})),!c&&n.on("click",function(){o.month=e.getMonth(),o.day=e.getDate(),o.update().hide()})})})}return t&&"month"!=t||(o.tables.month.head.add([i("tr.title").add([i("th.prev[title="+p.locale.prevYear+"]",{html:"&lt;"}).on("click",function(e){o.year--,o.show("month"),e.stopPropagation()}),i("th.year[colspan=6][title="+p.locale.year+"]").add(i("input[type=number][step=1][min="+(p.min.year||0)+"][max="+(p.max.year||9999)+"][value="+o.year+"]").on("change",function(t,n){e(n=Number(t.target.value))&&(o.year=n,o.show("month"),o.container.element.querySelector(".year input").focus())})),i("th.next[title="+p.locale.nextYear+"]",{html:"&gt;"}).on("click",function(e){o.year++,o.show("month"),e.stopPropagation()})])],!0),o.tables.month.body.clear(),c(o.year).forEach(function(e){var t=i("tr",{appendTo:o.tables.month.body});e.forEach(function(e){var n,a=".month",l=e.getMonth(),c=!u(e.getFullYear(),l+1),f=s(e,p.locale.titleMonth,p.locale);h.month&&r(h.month).compare(e)>=2&&(a+=".selected"),c&&(a+=".disabled"),r(e).compare(d)>=2&&(a+=".now"),c&&(a+=".disabled",f+=" ("+p.locale.disabled+")"),t.add(n=i("td[colspan=2][title="+f+"]"+a,{html:p.locale.monthNameShort[l]})),!c&&n.on("click",function(){o.date.setDate(1),o.month=l,p.monthYearOnly===!0?o.update().hide():o.show("day")})})})),this},get second(){return this.date.getSeconds()},set second(e){this.date.setSeconds(e)},show:function(e){e=p.monthYearOnly===!0?"month":e||"day",this.rebuild(e),this.visible=!0;for(var t in y)y.hasOwnProperty(t)&&y[t].classes[t==e?"remove":"add"]("hidden");var a=this.container.element,o=n;a.style.top=o.offsetTop+o.offsetHeight+"px",a.style.left=o.offsetLeft+"px",a.offsetWidth!=o.offsetWidth&&(a.style.width=o.offsetWidth+"px")},update:function(){return this.value=n.value=s(this.date,p.format,p._i18n),this.selected.day=new Date(this.date),"function"==typeof d.onChange&&d.onChange(n,this.date),this},get year(){return this.date.getFullYear()},set year(e){u(e)&&this.date.setFullYear(e)}}),t(d.date)&&o.update()||(n.value=""),o.element.on("click",function(e){o[o.visible?"hide":"show"]()}).on("keydown",function(e){var t,n,a,r,i,l=e.keyCode,c=e.target.selectionStart;37>l||l>40||((i=function(e){var t,n=[],i=0;return p.format.match(/(\{[^}]*\}|[^{]+)/g).forEach(function(l,c,h){t=/^\{(.*)\}$/.test(l)?s(o.date,l,p._i18n):l,(c=n.length)&&(n[c-1].end=i),n.push({fmt:l,val:t,beg:i,end:e.length,field:l!=t}),l!=t&&(r=n[c])&&(a||(a=r)),i+=t.length}),n})(e.target.value).forEach(function(s,h,d){if(c<a.beg)c=a.beg,t=a.end;else if(c>r.beg)c=r.beg,t=r.end;else if(!t&&c>=s.beg&&c<s.end)if(s.field&&e.target.selectionEnd==c)c=s.beg,t=s.end;else if(37==l){for(;h&&!n;)(n=d[--h]).field?(c=n.beg,t=n.end):n=null;t||(t=a.end)}else if(39==l){for(;++h<d.length&&!n;)(n=d[h]).field?(c=n.beg,t=n.end):n=null;t||(t=r.end)}else if(38==l||40==l)if(s.field){var u=s.fmt,f=38==l?1:-1;/D{1,2}/.test(u)?o.day+=f:/M{1,4}/.test(u)?o.month+=f:/YY(YY)?/.test(u)?o.year+=f:/HH?/i.test(u)?o.hour+=f:/mm?/.test(u)?o.minute+=f:/ss?/.test(u)?o.second+=f:/ap/.test(u)&&(o.hour+=12*f),o.update(),o.visible&&o.show(),n=i(e.target.value)[h],c=n.beg,t=n.end}else for(;h&&!n;)(n=d[--h]).field?(c=n.beg,t=n.end):n=null}),e.preventDefault(),e.target.selectionStart=c,e.target.selectionEnd=t||c)}).on("change",function(t){var n,a,r,i,s,l,c,h=t.target.value,d=0,u=!0;return p.format.match(/(\{[^}]*\}|[^{]+)/g).forEach(function(e,t,o){if(u)if(/^\{(.*)\}$/.test(e)){var f=h.slice(d);++t<o.length&&(f=f.slice(0,f.search(o[t]))),d+=f.length,e=e.slice(1,-1),"DD"==e||"D"==e?n=Number(f):"MMMM"==e?(p._i18n.monthName.forEach(function(e,t){!a&&f==e&&(a=t+1)}),a||(u=!1)):"MMM"==e?(p._i18n.monthNameShort.forEach(function(e,t){!a&&f==e&&(a=t+1)}),a||(u=!1)):"MM"==e||"M"==e?a=Number(f):"YYYY"==e||"YY"==e?r=Number(f):"HH"==e||"H"==e||"hh"==e||"h"==e?i=Number(f):"mm"==e||"m"==e?s=Number(f):"s"==e||"s"==e?l=Number(f):"ap"==e?(c=f)!=p._i18n.anteMeridiem&&c!=p._i18n.postMeridiem&&(u=!1):u=!1}else h.substr(d,e.length)==e?d+=e.length:u=!1}),u?(e(l)&&(o.second=l),e(s)&&(o.minute=s),e(i)&&(o.hour=i),e(n)&&(o.day=n),e(a)&&(o.month=a-1),e(r)&&(o.year=r),o.update(),void(o.visible&&o.show())):void(t.target.value=o.value)}),document.addEventListener("click",function(e,t){for(;t=t?t.parentNode:e.target;)if(t==n||t==g.element)return;o.hide()})}},this),this.locale=d.locale||(navigator?(navigator.userLanguage||navigator.language).replace("-","_"):null),h.instances.push(this)}return o.prototype={add:function(e,t){return t===!0&&this.clear(),(e instanceof Array?e:[e]).forEach(function(e){this.element.appendChild(e.element),e.parent=this},this),this},get classes(){return this.element.classList},clear:function(){for(var e,t=this.element;e=t.firstChild;)t.removeChild(e);return this},on:function(e,t){return(e instanceof Array?e:[e]).forEach(function(e){var n=this,a="function"==typeof t?function(e){return t.call(n,e)}:null;n.events[e]instanceof Array||(n.events[e]=[]),a?(n.events[e].push(a),n.element.addEventListener(e,a)):(n.events[e].forEach(function(t){n.element.removeEventListener(e,t)}),n.events[e]=[])},this),this}},h.VERSION=.3,h.instances=[],h.prototype={get format(){switch(this._fmt){case"{date}":return this._i18n.formatDate;case"{datetime}":return this._i18n.formatDateTime}return n(this._fmt)?this._fmt:""},set format(e){this._fmt=n(e)?e:""},get locale(){return this._i18n},set locale(e){h.i18n[e]&&h.i18n[e]!==this._i18n&&(this._i18n=h.i18n[e],this.instances.forEach(function(e){e.selected.day&&(e.day=e.date.getDate(),e.update()),e.rebuild()}))}},h.i18n={en_GB:{anteMeridiem:"㏂",dayOfWeek:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayOfWeekShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],disabled:"disabled",formatDate:"{D} {MMMM} {YYYY}",formatDateTime:"{D} {MMMM} {YYYY}, {h}:{mm} {ap}",month:"Month",monthName:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNameShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],nextMonth:"Next month",nextYear:"Next year",postMeridiem:"㏘",prevMonth:"Previous month",prevYear:"Previous year",selectMonth:"Select month",titleDay:"{DDDD} {D} {MMMM} {YYYY}",titleMonth:"{MMMM} {YYYY}",week:"Week",year:"Year"}},"undefined"!=typeof window&&(window.addEventListener("resize",function(e){h.instances.forEach(function(e){e.instances.forEach(function(e){e.visible&&e.show()})})}),window.Chronopic=h),"object"==typeof module&&module.exports&&(module.exports=h),h}();